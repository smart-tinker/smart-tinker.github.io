---
layout: post
title: "Архитектура"
date: 2024-11-22 10:31:00 +0300
categories: блог
---
Ну вот, с сайтом разобрались, я надеюсь.  

### Шаг второй - надо делать свою домашнюю лабораторию для экспериментов.  
Мы люди опытные, поэтому идём по заветам классического управления проектами

![2024-11-22-1.png](/img/2024-11-22-1.png)

Реализацию и документирование мы оставим на потом, а вот насчёт первых пунктов порассуждаем сейчас.

## Давайте определим зачем нам вот это вот всё.  
Я для себя принял, что домашняя лаборатория - это развитие обычной домашней инфраструктуры, с возможностью поднимать изолированные временные (и не очень) контуры, безопасно исследовать новое ПО при этом не мешая обычному интернет-сёрфингу домашних. Никаких облачных сервисов и желательно чтобы это всё было open-source.

## Где мы находимся и куда хотим попасть?  
Скорее всего у вас выглядит домашняя инфраструктура как-то так:  
![2024-11-22-2](/img/2024-11-22-2.png)  
Есть интернет от провайдера, который приходит на роутер, который одновременно является и вайфай точкой для всех устройств в доме.

И давайте подумаем чего мы хотели бы.  
Очевидно что надо разделять домашний сёрфинг от всего остального.  Поэтому это либо прокаченный роутер, который умеет файрвол и подсетки. Либо pfsense а за ним уже вайфай и подсеть лабы отдельно друг от друга.  
Так как нужно поднимать изолированные контуры под каждый набор ПО, то это либо виртуализация, либо контейнеризация. А скорее всего и то и другое.

# Виртуализация  
Тут у нас какие есть варианты: ProxmoxVE, oVirt, VirtualBox или прям жёсткий KVM. Есть ещё OpenStack, но это больше enterprise решение и поэтому тяжело разворачивать будет. Хотя кому-то может зайти.
VirtualBox плох по производительности, oVirt требует отдельной машины для управления, поэтому для меня на выбор остаётся только ProxmoxVE.

# Контейнеризация  
В Proxmox есть своя контейнеризация LXC, но она не сильно популярна. Сейчас сильно популярен именно docker. Очень много разработчиков ПО дают один из вариантов инсталляции именно как docker-контейнер. Я не хочу тратить время на портирование, поэтому нужен просто docker.  
Но пользоваться в чистом виде можно, но не комфортно, поэтому будем ставить с системой управления. В варианте Kubernetes или Rancher для нас это избыточно, так как у нас не одно приложение с множеством контейнеров, а много разрозненных приложений. А вот Portainer - вполне комфортен.

В итоге получается такая конструкция:  
![2024-11-22-3](/img/2024-11-22-3.png)